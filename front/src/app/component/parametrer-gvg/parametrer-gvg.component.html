<h1>Participant GvG du {{ dateGvG }}</h1>

<div *ngIf="participant?.ListeCompte" class="row container-fluid">

    <!-- liste des participants -->
    <mat-card class="col-lg-4 col-xs-12">
        <h2>Liste des participants</h2>

        <mat-selection-list (selectionChange)="ListerUniteParticipant($event.option.value)" #listeCompte [multiple]="false">
            <mat-list-option *ngFor="let element of participant.ListeCompte" [value]="element.Id">
                {{ element.Pseudo }}
            </mat-list-option>
        </mat-selection-list>
    </mat-card>

    <!-- liste unite du compte choisi -->
    <mat-card style="padding-left: 50px;" class="offset-lg-1 col-lg-7 col-xs-12">
        <h2>Unit√©s de: {{ listeCompte.selectedOptions.selected[0]?._text.nativeElement.innerText }}</h2>

        <mat-checkbox #checkboxFiltre (change)="FiltreUniteInfluance(checkboxFiltre.checked)" color="primary">
            Filtrer en fonction de l'influance restante
        </mat-checkbox>

        <p [ngStyle]="{ 'color': influanceMax >= influanceTotal ? 'green' : 'red' }">
            Total influance: {{ influanceTotal }} / {{ influanceMax }} <br>
            Reste: {{ influanceMax - influanceTotal }}
        </p>

        <p *ngIf="influanceMax < influanceTotal">Attention l'influance total est trop grande</p>

        <mat-selection-list color="primary">
            <mat-list-option #optionUnite [id]="'idOption' + element.Id"
                            (click)="CalculerInfluanceEtChoisiUnite(optionUnite, checkboxFiltre.checked, element)" 
                            [selected]="UniteEstChoisi(element.Id)"
                            checkboxPosition="before" 
                            *ngFor="let element of listeUnite" [value]="element.Id">
                {{ element.Nom }} - {{ element.NiveauMaitrise }} - {{ element.Influance }}
            </mat-list-option>
        </mat-selection-list>

        <button *ngIf="listeCompte.selectedOptions.selected[0]?._text.nativeElement.innerText" 
                mat-raised-button color="primary" class="btn-valider" (click)="Valider()">
            <mat-spinner *ngIf="btnClicker" diameter="21"></mat-spinner>
            {{ btnClicker ? '' : 'Valider la compo de: ' + listeCompte.selectedOptions.selected[0]?._text.nativeElement.innerText ?? '' }}
        </button>
    </mat-card>
</div>